<?xml version='1.0' encoding='UTF-8'?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui">

	<p:panel header="Relations" id="hierarchy-modal"
		style="min-height: 450px;height: 90%;height: calc(100% - 40px);position: relative;">
		<h:panelGrid id="hierarchySearchGrid" columns="8">
			<p:outputLabel value="Level" for="levelH" />
			<p:selectOneMenu id="levelH" label="Level"
				rendered="#{paramParentExtension ne 'PRO' and paramParentExtension ne 'CPT' and paramParentExtension ne 'DME'}"
				value="#{paramDlgCtrl.filterLevel}" appendTo="@this">
				 
				<f:selectItems itemLabel="#{level.value}" value="#{impactSearchController.levelListForIA}"
					itemValue="#{level.codelistInternalValue}" var="level"></f:selectItems>
				<p:ajax update="check" />
			</p:selectOneMenu>
			<p:selectOneMenu id="levelH2" label="Level"
				rendered="#{paramParentExtension eq 'PRO' or paramParentExtension eq 'CPT' or paramParentExtension eq 'DME'}"
				value="#{paramDlgCtrl.filterLevel}" >
 
				<f:selectItems itemLabel="#{level.codelistInternalValue eq 'PRO' ? '' : level.value}" value="#{impactSearchController.levelListForIA}" itemDisabled="#{level.codelistInternalValue eq 'PRO' or level.codelistInternalValue eq 'NC-LLT'}" 
					itemValue="#{level.codelistInternalValue}" var="level"></f:selectItems>
				<p:ajax update="check" />
			</p:selectOneMenu>
			<p:spacer width="10" />
			<p:outputLabel value="Term" for="termH" />
			<p:inputText id="termH" style="text-transform:uppercase"
				onkeypress="if (event.keyCode == 13) { return false; }"
				value="#{paramDlgCtrl.filterTermName}" />
			<p:commandButton value="Search" update="resultHier"
				action="#{paramDlgCtrl.hierarchySearch}"
				oncomplete="initRelationDND()" />

			<h:panelGrid columns="3">
				<p:spacer width="10" />
				<h:selectBooleanCheckbox id="check"
					disabled="#{paramDlgCtrl.filterLevel != 'PT' and paramDlgCtrl.filterLevel != 'LLT'}"
					value="#{paramDlgCtrl.showPrimaryPath}">
					<p:ajax update="resultHier"
						listener="#{paramDlgCtrl.collapseForPrimaryPathShowing}" />
				</h:selectBooleanCheckbox>
				<h:outputText style="font-weight: bold" value="Show Primary path" />
			</h:panelGrid>
		</h:panelGrid>

		<br />

		<h:panelGroup id="pc3"
			style="display:block;position: absolute;height:80%;height: calc(100% - 100px);width: 100%;margin-left: -16px;padding: 0 10px;box-sizing: border-box;overflow: auto;">
			<!--p:toolbar id="t4">
				<f:facet name="left">
					<p:commandButton id="filterH" value="Filter and Sort" type="button"
						icon="ui-icon-triangle-1-s" />
					<p:overlayPanel id="filterPanelH" for="filterH"
						showCloseIcon="true">
						<h:panelGrid columns="2">
							<p:outputLabel value="Sort" />
							<p:selectOneMenu value="TERM">
								<f:selectItem itemValue="TERM" itemLabel="Term name"></f:selectItem>
								<f:selectItem itemValue="DEF_LEVEL_REF_SHORT_NAME"
									itemLabel="Level"></f:selectItem>
 							</p:selectOneMenu>

							<p:outputLabel for="showH" value="Show Primary Only"
								style="min-width: 100px !important" />
							<p:selectBooleanCheckbox value="false" id="showH"
								label="Show Primary Only"></p:selectBooleanCheckbox>

							<p:spacer />
							<p:commandButton value="Refresh" id="cbH" icon="fa fa-refresh"
								rendered="true" />
						</h:panelGrid>
					</p:overlayPanel>
					<p:spacer width="5" />

				</f:facet>
			</p:toolbar -->
			<p:treeTable value="#{paramDlgCtrl.hierarchyRoot}" var="node"
				resizableColumns="true" id="resultHier" selectionMode="multiple"
				selection="#{paramDlgCtrl.selectedNodes}"
				styleClass="ui-treetable-resultHier hide-sel-chkbox full-width"
				rowStyleClass="#{node.rowStyleClass}">

				<f:attribute name="uiEventSourceName" value="hierarchy-search" />
				<p:ajax event="expand" listener="#{paramDlgCtrl.onNodeExpand}"
					update="resultHier">
				</p:ajax>

				<p:column headerText="Level">
					<h:outputText value="#{node.level}" />
				</p:column>

				<p:column headerText="Term">
					<h:outputText value="#{node.term}" />
				</p:column>

				<p:column headerText="Code" sortBy="#{node.code}"
					filterBy="#{node.code}">
					<h:outputText value="#{node.code}" />
					<h:outputText value="#{node.entity.id}"
						styleClass="ui-hidden data-entity-id" />
				</p:column>
			</p:treeTable>
		</h:panelGroup>
	</p:panel>

	<style>
#termH {
	text-transform: uppercase;
}

.ui-treetable.ui-treetable-resultHier .ui-treetable-selectable-node .ui-chkbox.ui-selection
	{
	display: none;
}

.ui-hidden {
	display: none;
}

.green-colored {
	color: #00c119;
}

.green-colored:HOVER {
	color: #009912;
}
</style>

</ui:composition>