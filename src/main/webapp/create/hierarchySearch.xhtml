<?xml version='1.0' encoding='UTF-8'?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui">

	<!-- <p:ajax event="close" listener="#{searchController.onCloseHierarchySearch}" update="@form:hierarchySearchGrid"/> -->
	
	<p:panel header="Relations" style="min-width:700px; min-height:560px; overflow: auto" id="hierarchy-modal">
		<h:panelGrid id="hierarchySearchGrid" columns="6">
			<p:outputLabel value="Level" for="levelH" />
			<p:selectOneMenu id="levelH" label="Level"  rendered="#{createController.detailsFormModel.extension ne 'PRO' and createController.detailsFormModel.extension ne 'CPT' and createController.detailsFormModel.extension ne 'DME'}"
				value="#{searchController.levelH}">
 				<f:selectItem itemValue="PRO" itemLabel="PRO"/> 				
 				<f:selectItem itemValue="SMQ1" itemLabel="SMQ1" />
				<f:selectItem itemValue="SMQ2" itemLabel="SMQ2" />
				<f:selectItem itemValue="SMQ3" itemLabel="SMQ3" />
				<f:selectItem itemValue="SMQ4" itemLabel="SMQ4" />
				<f:selectItem itemValue="SMQ5" itemLabel="SMQ5" />
				<f:selectItem itemValue="SOC" itemLabel="SOC" />
				<f:selectItem itemValue="HLGT" itemLabel="HLGT" />
				<f:selectItem itemValue="HLT" itemLabel="HLT" />
				<f:selectItem itemValue="PT" itemLabel="PT" />
				<f:selectItem itemValue="LLT" itemLabel="LLT" />
			</p:selectOneMenu>
			<p:selectOneMenu id="levelH2" label="Level"  rendered="#{createController.detailsFormModel.extension eq 'PRO' or createController.detailsFormModel.extension eq 'CPT' or createController.detailsFormModel.extension eq 'DME'}"
				value="#{searchController.levelH}">			
 				
 				<f:selectItem itemValue="SMQ1" itemLabel="SMQ1" />
				<f:selectItem itemValue="SMQ2" itemLabel="SMQ2" />
				<f:selectItem itemValue="SMQ3" itemLabel="SMQ3" />
				<f:selectItem itemValue="SMQ4" itemLabel="SMQ4" />
				<f:selectItem itemValue="SMQ5" itemLabel="SMQ5" />
				<f:selectItem itemValue="SOC" itemLabel="SOC" />
				<f:selectItem itemValue="HLGT" itemLabel="HLGT" />
				<f:selectItem itemValue="HLT" itemLabel="HLT" />
				<f:selectItem itemValue="PT" itemLabel="PT" />
				<f:selectItem itemValue="LLT" itemLabel="LLT" />
			</p:selectOneMenu>
			<p:spacer width="10" />
			<p:outputLabel value="Term" for="termH" />
			<p:inputText id="termH" style="text-transform:uppercase" onkeypress="if (event.keyCode == 13) { return false; }"
				value="#{searchController.termNameOfHierarchySearch}" />
			<p:commandButton value="Search" update="resultHier" action="#{searchController.hierarchySearch}" oncomplete="initRelationDND()"/>
		</h:panelGrid>

		<br />
		<h:panelGrid id="pc3" styleClass="AFStretchWidth">
			<p:toolbar id="t4">
				<f:facet name="left">
					<p:commandButton id="filterH" value="Filter and Sort" type="button"
						icon="ui-icon-triangle-1-s" />
					<p:overlayPanel id="filterPanelH" for="filterH"
						showCloseIcon="true">
						<h:panelGrid columns="2">
							<p:outputLabel value="Sort" />
							<p:selectOneMenu value="TERM">
								<f:selectItem itemValue="TERM" itemLabel="Term name"></f:selectItem>
								<f:selectItem itemValue="DEF_LEVEL_REF_SHORT_NAME"
									itemLabel="Level"></f:selectItem>
 							</p:selectOneMenu>

							<p:outputLabel for="showH" value="Show Primary Only"
								style="min-width: 100px !important" />
							<p:selectBooleanCheckbox value="false" id="showH"
								label="Show Primary Only"></p:selectBooleanCheckbox>

							<p:spacer />
							<p:commandButton value="Refresh" id="cbH" icon="fa fa-refresh"
								rendered="true" />
						</h:panelGrid>
					</p:overlayPanel>
					<p:spacer width="5" />

				</f:facet>
			</p:toolbar>

			<p:treeTable value="#{searchController.hierarchyRoot}" var="node"
				id="resultHier" rows="20" selectionMode="checkbox" selection="#{searchController.relationSelected}"
				styleClass="ui-treetable-resultHier" 
				paginator="true" paginatorPosition="bottom"
				paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
				rowsPerPageTemplate="5,10,25,30" rowStyleClass="#{node.rowStyleClass}">
	
				<f:attribute name="uiEventSourceName" value="hierarchy-search" />
				<p:ajax event="expand" listener="#{searchController.onNodeExpand}"
					update="resultHier">
						
				</p:ajax>

				<p:column headerText="Level">
					<h:outputText value="#{node.level}" />
				</p:column>

				<p:column headerText="Term">
					<h:outputText value="#{node.term}" />
				</p:column>

				<p:column headerText="Code" sortBy="#{node.code}" filterBy="#{node.code}">
					<h:outputText value="#{node.code}" />
					<h:outputText value="#{node.entity.id}" styleClass="ui-hidden data-entity-id" />
				</p:column>
			</p:treeTable>
		</h:panelGrid>
	</p:panel>

	<!-- <p:ajaxStatus onstart="PF('statusDialog').show()"
		onsuccess="PF('statusDialog').hide()" />

	<p:dialog style="background: none !important; border: none !important" widgetVar="statusDialog" modal="false" draggable="false"
		closable="false" resizable="false" showHeader="false">
		<img src="ajax-loader.gif" />
	</p:dialog> 	 -->

	<style>
		#termH {
			text-transform: uppercase;
		}
		
		.ui-treetable.ui-treetable-resultHier .ui-treetable-selectable-node .ui-chkbox.ui-selection {
			display: none;
		}
		.ui-hidden {
			display: none;
		}
		.green-colored {
			color: #00c119;
		}
		.green-colored:HOVER {
			color: #009912;
		}
	</style>

</ui:composition>